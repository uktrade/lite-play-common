@import components.common.upload.FileService
@import components.common.upload.FileView
@import components.common.upload.UploadValidationConfig
@import views.html.common.page._

@(form: Form[_], url: String, fileViews: java.util.List[FileView], labelVisuallyHidden: Boolean = false)(label: Html)

@uploadValidationConfig = @{
  ctx().args.get(FileService.CTX_UPLOAD_VALIDATION_CONFIG).asInstanceOf[UploadValidationConfig]
}


<script src="@controllers.common.routes.Assets.versioned("template/javascripts/jquery-file-upload/js/jquery.fileupload.js")"></script>

<div id="file-upload-container" @if(form.error(FileService.FILE_UPLOAD) != null){ class="form-group-error" }>

  @twoThirdsColumn {
    <div id="file-upload-label-fileupload" @if(labelVisuallyHidden) { class="visually-hidden" }>
      @if(labelVisuallyHidden) {
        @label.toString
      } else {
        <p>@label</p>
      }
    </div>
  }

  @if(form.error(FileService.FILE_UPLOAD) != null) {
    <span class="error-message">@form.error(FileService.FILE_UPLOAD).message</span>
  }

  <div class="file-upload-drop-target">
    <div class="file-upload-help-text">Drag and drop your files here <br>or</div>
    <button class="button secondary file-upload-button" tabindex="0">Select a file</button>
    <input id=@FileService.FILE_UPLOAD aria-labelledby="file-upload-label-fileupload" type="file" name="files[]"
      data-url="@url" data-upload-validation-disallowed-extensions="@uploadValidationConfig.getDisallowedExtensions"
      data-upload-validation-max-size="@uploadValidationConfig.getMaxSize" multiple>
  </div>
</div>

<table id="file-list" class="form-group @if(fileViews.isEmpty) {empty-file-list}">
  <thead>
    <tr>
      <th>File name</th>
      <th style="min-width: 202px">Size</th>
      <th><span class="visually-hidden">Actions</span></th>
    </tr>
  </thead>
  <tbody>
  @for(file <- fileViews) {
    <tr>
      <th class="file-upload-filename">
        <a href="@file.getLink" target="_blank">
          <span class="visually-hidden">Download</span>
          @file.getName
        </a>
      </th>
      <td class="file-upload-status">@file.getSize</td>
      <td>
        <button class="js-hidden" name="delete" value="@file.getId">Remove</button>
        <a href="#" class="file-delete-link" data-js-delete-link="@file.getJsDeleteLink">
          <div class="js-only">Remove</div>
          <span class="visually-hidden">@file.getName</span>
        </a>
      </td>
    </tr>
  }
  </tbody>
</table>

<script src="@controllers.common.routes.Assets.versioned("template/javascripts/lite-file-upload.js")"></script>
